[
    {
        "diksha_tpd_district_wise": "select a.*,round(coalesce(sum(sde.total_enrolled),0)*100/nullif(sum(sde.total_teachers),0),1) as percentage_teachers from (select district_id,district_name,collection_id,collection_name,round(cast(avg(collection_progress) as numeric),1) as collection_progress,'Last_Day' as time_range from diksha_tpd_agg where enrolled_date = (select now()::DATE) group by district_id,district_name,collection_id,collection_name union select district_id,district_name,collection_id,collection_name,round(cast(avg(collection_progress) as numeric),1) as collection_progress,'Last_7_Day' as time_range from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select (now()::Date)) group by district_id,district_name,collection_id,collection_name union select district_id,district_name,collection_id,collection_name,round(cast(avg(collection_progress) as numeric),1) as collection_progress,'Last_30_Day' as time_range from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select (now()::Date)) group by district_id,district_name,collection_id,collection_name union select district_id,district_name,collection_id,collection_name,round(cast(avg(collection_progress) as numeric),1) as collection_progress,'All' as time_range from diksha_tpd_agg group by district_id,district_name,collection_id,collection_name)as a left join school_diksha_enrolled as sde on a.district_id=sde.district_id and a.collection_id=sde.collection_id and a.time_range=sde.time_range group by a.district_id,a.district_name,a.collection_id,a.collection_name,a.collection_progress,a.time_range"
    },
    {
        "diksha_tpd_block_wise": "select a.*,round(coalesce(sum(sde.total_enrolled),0)*100/nullif(sum(sde.total_teachers),0),1) as percentage_teachers from (select block_id,block_name,district_id,district_name,collection_id,collection_name,round(cast(avg(collection_progress) as numeric),1) as collection_progress,'Last_Day' as time_range from diksha_tpd_agg where enrolled_date = (select now()::DATE) group by block_id,block_name,district_id,district_name,collection_id,collection_name union select block_id,block_name,district_id,district_name,collection_id,collection_name,round(cast(avg(collection_progress) as numeric),1) as collection_progress,'Last_7_Day' as time_range from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select (now()::Date)) group by block_id,block_name,district_id,district_name,collection_id,collection_name union select block_id,block_name,district_id,district_name,collection_id,collection_name,round(cast(avg(collection_progress) as numeric),1) as collection_progress,'Last_30_Day' as time_range from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select (now()::Date)) group by block_id,block_name,district_id,district_name,collection_id,collection_name union select block_id,block_name,district_id,district_name,collection_id,collection_name,round(cast(avg(collection_progress) as numeric),1) as collection_progress,'All' as time_range from diksha_tpd_agg group by block_id,block_name,district_id,district_name,collection_id,collection_name)as a left join school_diksha_enrolled as sde on a.block_id=sde.block_id and a.collection_id=sde.collection_id and a.time_range=sde.time_range group by a.district_id,a.district_name,a.block_id,a.block_name,a.collection_id,a.collection_name,a.collection_progress,a.time_range"
    },
    {
        "diksha_tpd_cluster_wise": "select a.*,round(coalesce(sum(sde.total_enrolled),0)*100/nullif(sum(sde.total_teachers),0),1) as percentage_teachers from (select cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name,round(cast(avg(collection_progress) as numeric),1) as collection_progress,'Last_Day' as time_range from diksha_tpd_agg where enrolled_date = (select now()::DATE) group by cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name union select cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name,round(cast(avg(collection_progress) as numeric),1) as collection_progress,'Last_7_Day' as time_range from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select (now()::Date)) group by cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name union select cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name,round(cast(avg(collection_progress) as numeric),1) as collection_progress,'Last_30_Day' as time_range from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select (now()::Date)) group by cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name union select cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name,round(cast(avg(collection_progress) as numeric),1) as collection_progress,'All' as time_range from diksha_tpd_agg group by cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name)as a left join school_diksha_enrolled as sde on a.cluster_id=sde.cluster_id and a.collection_id=sde.collection_id and a.time_range=sde.time_range group by a.district_id,a.district_name,a.block_id,a.block_name,a.cluster_id,a.cluster_name,a.collection_id,a.collection_name,a.collection_progress,a.time_range"
    },
    {
        "diksha_tpd_school_wise": "select a.*,round(coalesce(sum(sde.total_enrolled),0)*100/Nullif(sum(sde.total_teachers),0),1) as percentage_teachers from (select school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name,round(cast(avg(collection_progress) as numeric),1) as collection_progress,'Last_Day' as time_range from diksha_tpd_agg where enrolled_date = (select now()::DATE) group by school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name union select school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name,round(cast(avg(collection_progress) as numeric),1) as collection_progress,'Last_7_Day' as time_range from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select (now()::Date)) group by school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name union select school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name,round(cast(avg(collection_progress) as numeric),1) as collection_progress,'Last_30_Day' as time_range from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select (now()::Date)) group by school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name union select school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name,round(cast(avg(collection_progress) as numeric),1) as collection_progress,'All' as time_range from diksha_tpd_agg group by school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name)as a left join school_diksha_enrolled as sde on a.school_id=sde.school_id and a.collection_id=sde.collection_id and a.time_range=sde.time_range group by a.district_id,a.district_name,a.block_id,a.block_name,a.cluster_id,a.cluster_name,a.school_id,a.school_name,a.collection_id,a.collection_name,a.collection_progress,a.time_range"
    },
    {
        "diksha_tpd_r2_enrolment_meta": "select case when count>0 then True else FALSE end as data_is_available from (select count(*) from diksha_tpd_expected_enrollment where expected_enrollment is not null) as a;"
    },
    {
        "diksha_tpd_r2_certificate_meta": "select collection_id,collection_name,TRUE as certficate_status from(select distinct collection_id,collection_name,sum(certificate_count) as certificate_count from diksha_tpd_agg group by collection_id,collection_name) as a  where certificate_count>0 union select collection_id,collection_name,FALSE as certficate_status from(select distinct collection_id,collection_name,sum(certificate_count) as certificate_count from diksha_tpd_agg group by collection_id,collection_name) as a  where certificate_count=0;"
    },
    {
        "diksha_tpd_r2_district_overall": "select b.program_id,b.program_name,a.district_id,a.district_name,a.collection_id,a.collection_name,'all_program_collections' as type,'district' as level,sum(total_completed) as total_completed,sum(total_enrolled) as total_enrolled,round(cast(sum(total_enrolled)as decimal)*100.0/cast(sum(expected_enrollment)as decimal), 1)as total_enrolled_percentage,round(cast(sum(total_completed)as decimal)*100.0/cast(sum(expected_enrollment) as decimal),1)as percentage_completion,sum(expected_enrollment) as expected_total_enrolled,round(cast(sum(certificate_count)as decimal)*100.0/cast(sum(expected_enrollment) as decimal),1)as certificate_percentage,sum(certificate_count) as certificate_count,'All' as time_range from (select district_id,district_name,collection_id,collection_name,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'All' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg group by district_id,district_name,collection_id,collection_name) as a join (select collection_id,program_id,program_name,district_id,sum(expected_enrollment) as expected_enrollment from diksha_tpd_expected_enrollment  where program_name is not null group by collection_id,program_id,program_name,district_id) as b on a.collection_id=b.collection_id and a.district_id=b.district_id group by b.program_id,b.program_name,a.district_id,a.district_name,a.collection_id,a.collection_name UNION select '0' as program_id,'all' as program_name,district_id,district_name, '0' as collection_id, 'all' as collection_name,'all' as type,'district' as level,sum(total_completed) as total_completed,sum(total_enrolled) as total_enrolled,0 as total_enrolled_percentage,0 as percentage_completion,0 as expected_total_enrolled,0 as certificate_percentage,0 as certificate_count,'All' as time_range from diksha_tpd_agg group by district_id,district_name  union select b.program_id,b.program_name,a.district_id,a.district_name,'0' as collection_id,'all' as collection_name,'all_programs' as type,'district' as level,sum(total_completed) as total_completed,sum(total_enrolled) as total_enrolled,round(cast(sum(total_enrolled)as decimal)*100.0/cast(case when program_expected_enrollment>0 then max(program_expected_enrollment) else sum(expected_enrollment) end as decimal), 1)as total_enrolled_percentage,round(cast(sum(total_completed)as decimal)*100.0/cast(case when program_expected_enrollment>0 then max(program_expected_enrollment) else sum(expected_enrollment) end as decimal),1)as percentage_completion,case when program_expected_enrollment>0 then max(program_expected_enrollment) else sum(expected_enrollment) end  as expected_total_enrolled,round(cast(sum(certificate_count)as decimal)*100.0/cast(case when program_expected_enrollment>0 then max(program_expected_enrollment) else sum(expected_enrollment) end as decimal),1)as certificate_percentage,sum(certificate_count) as certificate_count,'All' as time_range from (select district_id,district_name,collection_id,collection_name,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'All' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg  group by district_id,district_name,collection_id,collection_name) as a join (select collection_id,program_id,program_name,district_id,program_expected_enrollment,sum(expected_enrollment) as expected_enrollment from diksha_tpd_expected_enrollment where program_name is not null group by collection_id,program_id,program_name,district_id,program_expected_enrollment) as b on a.collection_id=b.collection_id and a.district_id=b.district_id group by b.program_id,b.program_name,a.district_id,a.district_name,program_expected_enrollment UNION select '0' as program_id,'All' as program_name,a.district_id,a.district_name,a.collection_id,a.collection_name,'all_collections' as type,'district' as level,sum(total_completed) as total_completed,sum(total_enrolled) as total_enrolled,round(cast(sum(total_enrolled)as decimal)*100.0/cast(sum(expected_enrollment)as decimal), 1)as total_enrolled_percentage,round(cast(sum(total_completed)as decimal)*100.0/cast(sum(expected_enrollment) as decimal),1)as percentage_completion,sum(expected_enrollment) as expected_total_enrolled,round(cast(sum(certificate_count)as decimal)*100.0/cast(sum(expected_enrollment) as decimal),1)as certificate_percentage,sum(certificate_count) as certificate_count,'All' as time_range from (select district_id,district_name,collection_id,collection_name,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'All' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg group by district_id,district_name,collection_id,collection_name) as a join (select collection_id,district_id,sum(expected_enrollment) as expected_enrollment from diksha_tpd_expected_enrollment group by collection_id,district_id) as b on a.collection_id=b.collection_id and a.district_id=b.district_id group by a.district_id,a.district_name,a.collection_id,a.collection_name union  select '0' as program_id,'All' as program_name,district_id,district_name,collection_id,collection_name,'all_collections' as type,'district' as level,sum(total_completed) as total_completed,sum(total_enrolled) as total_enrolled,0 as total_enrolled_percentage,0 as percentage_completion,0 as expected_total_enrolled,0 as certificate_percentage,sum(certificate_count) as certificate_count,'All' as time_range from diksha_tpd_agg where collection_id not in(select distinct collection_id from diksha_tpd_expected_enrollment ) group by district_id,district_name,collection_id,collection_name;"
    },
    {
        "diksha_tpd_r2_district_last_90_days": "select b.program_id,b.program_name,a.district_id,a.district_name,a.collection_id,a.collection_name,'all_program_collections' as type,'district' as level,sum(total_completed) as total_completed,sum(total_enrolled) as total_enrolled,round(cast(sum(total_enrolled)as decimal)*100.0/cast(sum(expected_enrollment)as decimal), 1)as total_enrolled_percentage,round(cast(sum(total_completed)as decimal)*100.0/cast(sum(expected_enrollment) as decimal),1)as percentage_completion,sum(expected_enrollment) as expected_total_enrolled,round(cast(sum(certificate_count)as decimal)*100.0/cast(sum(expected_enrollment) as decimal),1)as certificate_percentage,sum(certificate_count) as certificate_count,'Last_90_Day' as time_range from (select district_id,district_name,collection_id,collection_name,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,sum(certificate_count) as certificate_count from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '90 DAY')::Date) and (select now()::DATE) group by district_id,district_name,collection_id,collection_name) as a join (select collection_id,program_id,program_name,district_id,sum(expected_enrollment) as expected_enrollment from diksha_tpd_expected_enrollment where course_start_date between (select ((now()::Date)-INTERVAL '90 DAY')::Date) and (select now()::DATE) OR course_end_date between (select ((now()::Date)-INTERVAL '90 DAY')::Date) and (select now()::DATE) and program_name is not null group by collection_id,program_id,program_name,district_id) as b on a.collection_id=b.collection_id and a.district_id=b.district_id group by b.program_id,b.program_name,a.district_id,a.district_name,a.collection_id,a.collection_name UNION select '0' as program_id,'all' as program_name,district_id,district_name, '0' as collection_id, 'all' as collection_name,'all' as type,'district' as level,sum(total_completed) as total_completed,sum(total_enrolled) as total_enrolled,0 as total_enrolled_percentage,0 as percentage_completion,0 as expected_total_enrolled,0 as certificate_percentage,0 as certificate_count,'Last_90_Day' as time_range from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '90 DAY')::Date) and (select now()::DATE) group by district_id,district_name,collection_id,collection_name union select b.program_id,b.program_name,a.district_id,a.district_name,'0' as collection_id,'all' as collection_name,'all_programs' as type,'district' as level,sum(total_completed) as total_completed,sum(total_enrolled) as total_enrolled,round(cast(sum(total_enrolled)as decimal)*100.0/cast(sum(expected_enrollment)as decimal), 1)as total_enrolled_percentage,round(cast(sum(total_completed)as decimal)*100.0/cast(sum(expected_enrollment) as decimal),1)as percentage_completion,sum(expected_enrollment) as expected_total_enrolled,round(cast(sum(certificate_count)as decimal)*100.0/cast(sum(expected_enrollment) as decimal),1)as certificate_percentage,sum(certificate_count) as certificate_count,'Last_90_Day' as time_range from (select district_id,district_name,collection_id,collection_name,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,sum(certificate_count) as certificate_count from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '90 DAY')::Date) and (select now()::DATE) group by district_id,district_name,collection_id,collection_name) as a join (select collection_id,program_id,program_name,district_id,sum(expected_enrollment) as expected_enrollment from diksha_tpd_expected_enrollment where program_name is not null and course_start_date between (select ((now()::Date)-INTERVAL '90 DAY')::Date) and (select now()::DATE) OR course_end_date between (select ((now()::Date)-INTERVAL '90 DAY')::Date) and (select now()::DATE) group by collection_id,program_id,program_name,district_id) as b on a.collection_id=b.collection_id and a.district_id=b.district_id group by b.program_id,b.program_name,a.district_id,a.district_name UNION select '0' as program_id,'All' as program_name,a.district_id,a.district_name,a.collection_id,a.collection_name,'all_collections' as type,'district' as level,sum(total_completed) as total_completed,sum(total_enrolled) as total_enrolled,round(cast(sum(total_enrolled)as decimal)*100.0/cast(sum(expected_enrollment)as decimal), 1)as total_enrolled_percentage,round(cast(sum(total_completed)as decimal)*100.0/cast(sum(expected_enrollment) as decimal),1)as percentage_completion,sum(expected_enrollment) as expected_total_enrolled,round(cast(sum(certificate_count)as decimal)*100.0/cast(sum(expected_enrollment) as decimal),1)as certificate_percentage,sum(certificate_count) as certificate_count,'Last_90_Day' as time_range from (select district_id,district_name,collection_id,collection_name,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,sum(certificate_count) as certificate_count from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '90 DAY')::Date) and (select now()::DATE) group by district_id,district_name,collection_id,collection_name) as a join (select collection_id,district_id,sum(expected_enrollment) as expected_enrollment from diksha_tpd_expected_enrollment where course_start_date between (select ((now()::Date)-INTERVAL '90 DAY')::Date) and (select now()::DATE) OR course_end_date between (select ((now()::Date)-INTERVAL '90 DAY')::Date) and (select now()::DATE) group by collection_id,district_id) as b on a.collection_id=b.collection_id and a.district_id=b.district_id group by a.district_id,a.district_name,a.collection_id,a.collection_name UNION select '0' as program_id,'All' as program_name,district_id,district_name,collection_id,collection_name,'all_collections' as type,'district' as level,sum(total_completed) as total_completed,sum(total_enrolled) as total_enrolled,0 as total_enrolled_percentage,0 as percentage_completion,0 as expected_total_enrolled,0 as certificate_percentage,sum(certificate_count) as certificate_count,'All' as time_range from diksha_tpd_agg where collection_id not in(select distinct collection_id from diksha_tpd_expected_enrollment where course_start_date between (select ((now()::Date)-INTERVAL '90 DAY')::Date) and (select now()::DATE) OR course_end_date between (select ((now()::Date)-INTERVAL '90 DAY')::Date) and (select now()::DATE)) and enrolled_date between (select ((now()::Date)-INTERVAL '90 DAY')::Date) and (select now()::DATE) group by district_id,district_name,collection_id,collection_name;"
    },
    {
        "diksha_tpd_r2_district_last_30_days": "select b.program_id,b.program_name,a.district_id,a.district_name,a.collection_id,a.collection_name,'all_program_collections' as type,'district' as level,sum(total_completed) as total_completed,sum(total_enrolled) as total_enrolled,round(cast(sum(total_enrolled)as decimal)*100.0/cast(sum(expected_enrollment)as decimal), 1)as total_enrolled_percentage,round(cast(sum(total_completed)as decimal)*100.0/cast(sum(expected_enrollment) as decimal),1)as percentage_completion,sum(expected_enrollment) as expected_total_enrolled,round(cast(sum(certificate_count)as decimal)*100.0/cast(sum(expected_enrollment) as decimal),1)as certificate_percentage,sum(certificate_count) as certificate_count,'Last_30_Day' as time_range from (select district_id,district_name,collection_id,collection_name,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,sum(certificate_count) as certificate_count from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE) group by district_id,district_name,collection_id,collection_name) as a join (select collection_id,program_id,program_name,district_id,sum(expected_enrollment) as expected_enrollment from diksha_tpd_expected_enrollment where course_start_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE) OR course_end_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE) and program_name is not null group by collection_id,program_id,program_name,district_id) as b on a.collection_id=b.collection_id and a.district_id=b.district_id group by b.program_id,b.program_name,a.district_id,a.district_name,a.collection_id,a.collection_name UNION select '0' as program_id,'all' as program_name,district_id,district_name, '0' as collection_id, 'all' as collection_name,'all' as type,'district' as level,sum(total_completed) as total_completed,sum(total_enrolled) as total_enrolled,0 as total_enrolled_percentage,0 as percentage_completion,0 as expected_total_enrolled,0 as certificate_percentage,0 as certificate_count,'Last_30_Day' as time_range from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE) group by district_id,district_name,collection_id,collection_name union select b.program_id,b.program_name,a.district_id,a.district_name,'0' as collection_id,'all' as collection_name,'all_programs' as type,'district' as level,sum(total_completed) as total_completed,sum(total_enrolled) as total_enrolled,round(cast(sum(total_enrolled)as decimal)*100.0/cast(case when program_expected_enrollment>0 then max(program_expected_enrollment) else sum(expected_enrollment) end as decimal), 1)as total_enrolled_percentage,round(cast(sum(total_completed)as decimal)*100.0/cast(case when program_expected_enrollment>0 then max(program_expected_enrollment) else sum(expected_enrollment) end as decimal),1)as percentage_completion,case when program_expected_enrollment>0 then max(program_expected_enrollment) else sum(expected_enrollment) end  as expected_total_enrolled,round(cast(sum(certificate_count)as decimal)*100.0/cast(case when program_expected_enrollment>0 then max(program_expected_enrollment) else sum(expected_enrollment) end as decimal),1)as certificate_percentage,sum(certificate_count) as certificate_count,'All' as time_range from (select district_id,district_name,collection_id,collection_name,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'Last_30_Day' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE) group by district_id,district_name,collection_id,collection_name) as a join (select collection_id,program_id,program_name,district_id,program_expected_enrollment,sum(expected_enrollment) as expected_enrollment from diksha_tpd_expected_enrollment where program_name is not null and course_start_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE) OR course_end_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE)  group by collection_id,program_id,program_name,district_id,program_expected_enrollment) as b on a.collection_id=b.collection_id and a.district_id=b.district_id group by b.program_id,b.program_name,a.district_id,a.district_name,program_expected_enrollment  UNION select '0' as program_id,'All' as program_name,a.district_id,a.district_name,a.collection_id,a.collection_name,'all_collections' as type,'district' as level,sum(total_completed) as total_completed,sum(total_enrolled) as total_enrolled,round(cast(sum(total_enrolled)as decimal)*100.0/cast(sum(expected_enrollment)as decimal), 1)as total_enrolled_percentage,round(cast(sum(total_completed)as decimal)*100.0/cast(sum(expected_enrollment) as decimal),1)as percentage_completion,sum(expected_enrollment) as expected_total_enrolled,round(cast(sum(certificate_count)as decimal)*100.0/cast(sum(expected_enrollment) as decimal),1)as certificate_percentage,sum(certificate_count) as certificate_count,'Last_30_Day' as time_range from (select district_id,district_name,collection_id,collection_name,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,sum(certificate_count) as certificate_count from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE) group by district_id,district_name,collection_id,collection_name) as a join (select collection_id,district_id,sum(expected_enrollment) as expected_enrollment from diksha_tpd_expected_enrollment where course_start_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE) OR course_end_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE) group by collection_id,district_id) as b on a.collection_id=b.collection_id and a.district_id=b.district_id group by a.district_id,a.district_name,a.collection_id,a.collection_name UNION select '0' as program_id,'All' as program_name,district_id,district_name,collection_id,collection_name,'all_collections' as type,'district' as level,sum(total_completed) as total_completed,sum(total_enrolled) as total_enrolled,0 as total_enrolled_percentage,0 as percentage_completion,0 as expected_total_enrolled,0 as certificate_percentage,sum(certificate_count) as certificate_count,'All' as time_range from diksha_tpd_agg where collection_id not in(select distinct collection_id from diksha_tpd_expected_enrollment where course_start_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE) OR course_end_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE)) and enrolled_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE) group by district_id,district_name,collection_id,collection_name;"
    },
    {
        "diksha_tpd_r2_district_last_7_days": "select b.program_id,b.program_name,a.district_id,a.district_name,a.collection_id,a.collection_name,'all_program_collections' as type,'district' as level,sum(total_completed) as total_completed,sum(total_enrolled) as total_enrolled,round(cast(sum(total_enrolled)as decimal)*100.0/cast(sum(expected_enrollment)as decimal), 1)as total_enrolled_percentage,round(cast(sum(total_completed)as decimal)*100.0/cast(sum(expected_enrollment) as decimal),1)as percentage_completion,sum(expected_enrollment) as expected_total_enrolled,round(cast(sum(certificate_count)as decimal)*100.0/cast(sum(expected_enrollment) as decimal),1)as certificate_percentage,sum(certificate_count) as certificate_count,'Last_7_Day' as time_range from (select district_id,district_name,collection_id,collection_name,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,sum(certificate_count) as certificate_count from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE) group by district_id,district_name,collection_id,collection_name) as a join (select collection_id,program_id,program_name,district_id,sum(expected_enrollment) as expected_enrollment from diksha_tpd_expected_enrollment where course_end_date is not null and course_start_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE) OR course_end_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE) group by collection_id,program_id,program_name,district_id) as b on a.collection_id=b.collection_id and a.district_id=b.district_id group by b.program_id,b.program_name,a.district_id,a.district_name,a.collection_id,a.collection_name UNION select '0' as program_id,'all' as program_name,district_id,district_name, '0' as collection_id, 'all' as collection_name,'all' as type,'district' as level,sum(total_completed) as total_completed,sum(total_enrolled) as total_enrolled,0 as total_enrolled_percentage,0 as percentage_completion,0 as expected_total_enrolled,0 as certificate_percentage,0 as certificate_count,'Last_7_Day' as time_range from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE) group by district_id,district_name,collection_id,collection_name union select b.program_id,b.program_name,a.district_id,a.district_name,'0' as collection_id,'all' as collection_name,'all_programs' as type,'district' as level,sum(total_completed) as total_completed,sum(total_enrolled) as total_enrolled,round(cast(sum(total_enrolled)as decimal)*100.0/cast(case when program_expected_enrollment>0 then max(program_expected_enrollment) else sum(expected_enrollment) end as decimal), 1)as total_enrolled_percentage,round(cast(sum(total_completed)as decimal)*100.0/cast(case when program_expected_enrollment>0 then max(program_expected_enrollment) else sum(expected_enrollment) end as decimal),1)as percentage_completion,case when program_expected_enrollment>0 then max(program_expected_enrollment) else sum(expected_enrollment) end  as expected_total_enrolled,round(cast(sum(certificate_count)as decimal)*100.0/cast(case when program_expected_enrollment>0 then max(program_expected_enrollment) else sum(expected_enrollment) end as decimal),1)as certificate_percentage,sum(certificate_count) as certificate_count,'All' as time_range from (select district_id,district_name,collection_id,collection_name,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'Last_7_Day' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE) group by district_id,district_name,collection_id,collection_name) as a join (select collection_id,program_id,program_name,district_id,program_expected_enrollment,sum(expected_enrollment) as expected_enrollment from diksha_tpd_expected_enrollment where program_name is not null and course_start_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE) OR course_end_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE)  group by collection_id,program_id,program_name,district_id,program_expected_enrollment) as b on a.collection_id=b.collection_id and a.district_id=b.district_id group by b.program_id,b.program_name,a.district_id,a.district_name,program_expected_enrollment UNION select '0' as program_id,'All' as program_name,a.district_id,a.district_name,a.collection_id,a.collection_name,'all_collections' as type,'district' as level,sum(total_completed) as total_completed,sum(total_enrolled) as total_enrolled,round(cast(sum(total_enrolled)as decimal)*100.0/cast(sum(expected_enrollment)as decimal), 1)as total_enrolled_percentage,round(cast(sum(total_completed)as decimal)*100.0/cast(sum(expected_enrollment) as decimal),1)as percentage_completion,sum(expected_enrollment) as expected_total_enrolled,round(cast(sum(certificate_count)as decimal)*100.0/cast(sum(expected_enrollment) as decimal),1)as certificate_percentage,sum(certificate_count) as certificate_count,'Last_7_Day' as time_range from (select district_id,district_name,collection_id,collection_name,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,sum(certificate_count) as certificate_count from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE) group by district_id,district_name,collection_id,collection_name) as a join (select collection_id,district_id,sum(expected_enrollment) as expected_enrollment from diksha_tpd_expected_enrollment where course_end_date is not null and course_start_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE) OR course_end_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE) group by collection_id,district_id) as b on a.collection_id=b.collection_id and a.district_id=b.district_id group by a.district_id,a.district_name,a.collection_id,a.collection_name  UNION select '0' as program_id,'All' as program_name,district_id,district_name,collection_id,collection_name,'all_collections' as type,'district' as level,sum(total_completed) as total_completed,sum(total_enrolled) as total_enrolled,0 as total_enrolled_percentage,0 as percentage_completion,0 as expected_total_enrolled,0 as certificate_percentage,sum(certificate_count) as certificate_count,'All' as time_range from diksha_tpd_agg where collection_id not in(select distinct collection_id from diksha_tpd_expected_enrollment where course_start_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE) OR course_end_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE)) and enrolled_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE) group by district_id,district_name,collection_id,collection_name;"
    },
    {
        "diksha_tpd_r2_district_last_day": "select b.program_id,b.program_name,a.district_id,a.district_name,a.collection_id,a.collection_name,'all_program_collections' as type,'district' as level,sum(total_completed) as total_completed,sum(total_enrolled) as total_enrolled,round(cast(sum(total_enrolled)as decimal)*100.0/cast(sum(expected_enrollment)as decimal), 1)as total_enrolled_percentage,round(cast(sum(total_completed)as decimal)*100.0/cast(sum(expected_enrollment) as decimal),1)as percentage_completion,sum(expected_enrollment) as expected_total_enrolled,round(cast(sum(certificate_count)as decimal)*100.0/cast(sum(expected_enrollment) as decimal),1)as certificate_percentage,sum(certificate_count) as certificate_count,'Last_Day' as time_range from (select district_id,district_name,collection_id,collection_name,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,sum(certificate_count) as certificate_count from diksha_tpd_agg where enrolled_date = (select ((now()::Date)-INTERVAL '1 DAY')::Date)  group by district_id,district_name,collection_id,collection_name) as a join (select collection_id,program_id,program_name,district_id,sum(expected_enrollment) as expected_enrollment from diksha_tpd_expected_enrollment where course_end_date is not null and  course_start_date = (select ((now()::Date)-INTERVAL '1 DAY')::Date) OR course_end_date = (select ((now()::Date)-INTERVAL '1 DAY')::Date) group by collection_id,program_id,program_name,district_id) as b on a.collection_id=b.collection_id and a.district_id=b.district_id group by b.program_id,b.program_name,a.district_id,a.district_name,a.collection_id,a.collection_name UNION select '0' as program_id,'all' as program_name,district_id,district_name, '0' as collection_id, 'all' as collection_name,'all' as type,'district' as level,sum(total_completed) as total_completed,sum(total_enrolled) as total_enrolled,0 as total_enrolled_percentage,0 as percentage_completion,0 as expected_total_enrolled,0 as certificate_percentage,0 as certificate_count,'Last_Day' as time_range from diksha_tpd_agg where enrolled_date = (select ((now()::Date)-INTERVAL '1 DAY')::Date)  group by district_id,district_name,collection_id,collection_name union select b.program_id,b.program_name,a.district_id,a.district_name,'0' as collection_id,'all' as collection_name,'all_programs' as type,'district' as level,sum(total_completed) as total_completed,sum(total_enrolled) as total_enrolled,round(cast(sum(total_enrolled)as decimal)*100.0/cast(case when program_expected_enrollment>0 then max(program_expected_enrollment) else sum(expected_enrollment) end as decimal), 1)as total_enrolled_percentage,round(cast(sum(total_completed)as decimal)*100.0/cast(case when program_expected_enrollment>0 then max(program_expected_enrollment) else sum(expected_enrollment) end as decimal),1)as percentage_completion,case when program_expected_enrollment>0 then max(program_expected_enrollment) else sum(expected_enrollment) end  as expected_total_enrolled,round(cast(sum(certificate_count)as decimal)*100.0/cast(case when program_expected_enrollment>0 then max(program_expected_enrollment) else sum(expected_enrollment) end as decimal),1)as certificate_percentage,sum(certificate_count) as certificate_count,'All' as time_range from (select district_id,district_name,collection_id,collection_name,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'Last_30_Day' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg where enrolled_date = (select ((now()::Date)-INTERVAL '1 DAY')::Date)  group by district_id,district_name,collection_id,collection_name) as a join (select collection_id,program_id,program_name,district_id,program_expected_enrollment,sum(expected_enrollment) as expected_enrollment from diksha_tpd_expected_enrollment where program_name is not null and course_start_date = (select ((now()::Date)-INTERVAL '1 DAY')::Date) OR course_end_date = (select ((now()::Date)-INTERVAL '1 DAY')::Date)  group by collection_id,program_id,program_name,district_id,program_expected_enrollment) as b on a.collection_id=b.collection_id and a.district_id=b.district_id group by b.program_id,b.program_name,a.district_id,a.district_name,program_expected_enrollment UNION select '0' as program_id,'All' as program_name,a.district_id,a.district_name,a.collection_id,a.collection_name,'all_collections' as type,'district' as level,sum(total_completed) as total_completed,sum(total_enrolled) as total_enrolled,round(cast(sum(total_enrolled)as decimal)*100.0/cast(sum(expected_enrollment)as decimal), 1)as total_enrolled_percentage,round(cast(sum(total_completed)as decimal)*100.0/cast(sum(expected_enrollment) as decimal),1)as percentage_completion,sum(expected_enrollment) as expected_total_enrolled,round(cast(sum(certificate_count)as decimal)*100.0/cast(sum(expected_enrollment) as decimal),1)as certificate_percentage,sum(certificate_count) as certificate_count,'Last_Day' as time_range from (select district_id,district_name,collection_id,collection_name,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,sum(certificate_count) as certificate_count from diksha_tpd_agg where enrolled_date = (select ((now()::Date)-INTERVAL '1 DAY')::Date) group by district_id,district_name,collection_id,collection_name) as a join (select collection_id,district_id,sum(expected_enrollment) as expected_enrollment from diksha_tpd_expected_enrollment where course_end_date is not null and course_start_date = (select ((now()::Date)-INTERVAL '1 DAY')::Date) OR course_end_date = (select ((now()::Date)-INTERVAL '1 DAY')::Date)  group by collection_id,district_id) as b on a.collection_id=b.collection_id and a.district_id=b.district_id group by a.district_id,a.district_name,a.collection_id,a.collection_name  UNION  select '0' as program_id,'All' as program_name,district_id,district_name,collection_id,collection_name,'all_collections' as type,'district' as level,sum(total_completed) as total_completed,sum(total_enrolled) as total_enrolled,0 as total_enrolled_percentage,0 as percentage_completion,0 as expected_total_enrolled,0 as certificate_percentage,sum(certificate_count) as certificate_count,'All' as time_range from diksha_tpd_agg where collection_id not in(select distinct collection_id from diksha_tpd_expected_enrollment where course_start_date = (select ((now()::Date)-INTERVAL '1 DAY')::Date) OR course_end_date = (select ((now()::Date)-INTERVAL '1 DAY')::Date)) and enrolled_date = (select ((now()::Date)-INTERVAL '1 DAY')::Date) group by district_id,district_name,collection_id,collection_name;"
    },
    {
        "diksha_tpd_r2_block_last_day": "select block_id,block_name,dta.district_id,district_name,dta.collection_id,dta.collection_name,program_id,program_name,'all_program_collections' as type,'block' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'Last_Day' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg dta join diksha_tpd_expected_enrollment dte on dta.collection_id=dte.collection_id  and dta.district_id=dte.district_id where enrolled_date = (select ((now()::Date)-INTERVAL '1 DAY')::Date)  and program_name is not NULL group by block_id,block_name,dta.district_id,dta.district_name,dta.collection_id,dta.collection_name,program_id,program_name  UNION select block_id,block_name,dta.district_id,district_name,'0' as collection_id,'All' as collection_name,program_id,program_name,'all_programs' as type,'block' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'Last_Day' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg dta join diksha_tpd_expected_enrollment dte on dta.collection_id=dte.collection_id  and dta.district_id=dte.district_id  where enrolled_date = (select ((now()::Date)-INTERVAL '1 DAY')::Date)  and program_name is not NULL group by block_id,block_name,dta.district_id,dta.district_name,program_id,program_name UNION select block_id,block_name,dta.district_id,district_name,dta.collection_id,dta.collection_name,'0' as program_id,'all' as program_name,'all_collections' as type,'block' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'Last_Day' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg dta where enrolled_date =  (select ((now()::Date)-INTERVAL '1 DAY')::Date)  group by block_id,block_name,dta.district_id,dta.district_name,dta.collection_id,dta.collection_name UNION select block_id,block_name,dta.district_id,district_name,'0' as collection_id,'All' as collection_name,'0' as program_id,'All' as program_name,'all' as type,'block' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'Last_Day' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg dta where enrolled_date = (select ((now()::Date)-INTERVAL '1 DAY')::Date) group by block_id,block_name,dta.district_id,dta.district_name;"
    },
    {
        "diksha_tpd_r2_block_last_7_days": "select block_id,block_name,dta.district_id,district_name,dta.collection_id,dta.collection_name,program_id,program_name,'all_program_collections' as type,'block' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'Last_7_Day' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg dta join diksha_tpd_expected_enrollment dte on dta.collection_id=dte.collection_id  and dta.district_id=dte.district_id where enrolled_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE)  and program_name is not NULL group by block_id,block_name,dta.district_id,dta.district_name,dta.collection_id,dta.collection_name,program_id,program_name UNION select block_id,block_name,dta.district_id,district_name,'0' as collection_id,'All' as collection_name,program_id,program_name,'all_programs' as type,'block' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'Last_7_Day' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg dta join diksha_tpd_expected_enrollment dte on dta.collection_id=dte.collection_id  and dta.district_id=dte.district_id  where enrolled_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE)  and program_name is not NULL group by block_id,block_name,dta.district_id,dta.district_name,program_id,program_name UNION select block_id,block_name,dta.district_id,district_name,dta.collection_id,dta.collection_name,'0' as program_id,'all' as program_name,'all_collections' as type,'block' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'Last_7_Day' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg dta  where enrolled_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE)  group by block_id,block_name,dta.district_id,dta.district_name,dta.collection_id,dta.collection_name UNION select block_id,block_name,dta.district_id,district_name,'0' as collection_id,'All' as collection_name,'0' as program_id,'All' as program_name,'all' as type,'block' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'Last_7_Day' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg dta  where enrolled_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE)  group by block_id,block_name,dta.district_id,dta.district_name;"
    },
    {
        "diksha_tpd_r2_block_last_30_days": "select block_id,block_name,dta.district_id,district_name,dta.collection_id,dta.collection_name,program_id,program_name,'all_program_collections' as type,'block' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'Last_30_Day' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg dta join diksha_tpd_expected_enrollment dte on dta.collection_id=dte.collection_id  and dta.district_id=dte.district_id where enrolled_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE)  and program_name is not NULL group by block_id,block_name,dta.district_id,dta.district_name,dta.collection_id,dta.collection_name,program_id,program_name UNION select block_id,block_name,dta.district_id,district_name,'0' as collection_id,'All' as collection_name,program_id,program_name,'all_programs' as type,'block' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'Last_30_Day' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg dta join diksha_tpd_expected_enrollment dte on dta.collection_id=dte.collection_id  and dta.district_id=dte.district_id  where enrolled_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE)  and program_name is not NULL group by block_id,block_name,dta.district_id,dta.district_name,program_id,program_name UNION select block_id,block_name,dta.district_id,district_name,dta.collection_id,dta.collection_name,'0' as program_id,'all' as program_name,'all_collections' as type,'block' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'Last_30_Day' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg dta  where enrolled_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE)  group by block_id,block_name,dta.district_id,dta.district_name,dta.collection_id,dta.collection_name UNION select block_id,block_name,dta.district_id,district_name,'0' as collection_id,'All' as collection_name,'0' as program_id,'All' as program_name,'all' as type,'block' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'Last_30_Day' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg dta  where enrolled_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE)  group by block_id,block_name,dta.district_id,dta.district_name;"
    },
    {
        "diksha_tpd_r2_block_last_90_days": "select block_id,block_name,dta.district_id,district_name,dta.collection_id,dta.collection_name,program_id,program_name,'all_program_collections' as type,'block' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'Last_90_Day' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg dta join diksha_tpd_expected_enrollment dte on dta.collection_id=dte.collection_id  and dta.district_id=dte.district_id where enrolled_date between (select ((now()::Date)-INTERVAL '90 DAY')::Date) and (select now()::DATE)  and program_name is not NULL group by block_id,block_name,dta.district_id,dta.district_name,dta.collection_id,dta.collection_name,program_id,program_name UNION select block_id,block_name,dta.district_id,district_name,'0' as collection_id,'All' as collection_name,program_id,program_name,'all_programs' as type,'block' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'Last_90_Day' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg dta join diksha_tpd_expected_enrollment dte on dta.collection_id=dte.collection_id  and dta.district_id=dte.district_id  where enrolled_date between (select ((now()::Date)-INTERVAL '90 DAY')::Date) and (select now()::DATE)  and program_name is not NULL group by block_id,block_name,dta.district_id,dta.district_name,program_id,program_name UNION select block_id,block_name,dta.district_id,district_name,dta.collection_id,dta.collection_name,'0' as program_id,'all' as program_name,'all_collections' as type,'block' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'Last_90_Day' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg dta  where enrolled_date between (select ((now()::Date)-INTERVAL '90 DAY')::Date) and (select now()::DATE)  group by block_id,block_name,dta.district_id,dta.district_name,dta.collection_id,dta.collection_name UNION select block_id,block_name,dta.district_id,district_name,'0' as collection_id,'All' as collection_name,'0' as program_id,'All' as program_name,'all' as type,'block' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'Last_90_Day' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg dta  where enrolled_date between (select ((now()::Date)-INTERVAL '90 DAY')::Date) and (select now()::DATE)  group by block_id,block_name,dta.district_id,dta.district_name;"
    },
    {
        "diksha_tpd_r2_block_overall": "select block_id,block_name,dta.district_id,district_name,dta.collection_id,dta.collection_name,program_id,program_name,'all_program_collections' as type,'block' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'All' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg dta join diksha_tpd_expected_enrollment dte on dta.collection_id=dte.collection_id  and dta.district_id=dte.district_id  where program_name is not NULL group by block_id,block_name,dta.district_id,dta.district_name,dta.collection_id,dta.collection_name,program_id,program_name UNION select block_id,block_name,dta.district_id,district_name,'0' as collection_id,'All' as collection_name,program_id,program_name,'all_programs' as type,'block' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'All' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg dta join diksha_tpd_expected_enrollment dte on dta.collection_id=dte.collection_id  and dta.district_id=dte.district_id  where program_name is not NULL group by block_id,block_name,dta.district_id,dta.district_name,program_id,program_name UNION select block_id,block_name,dta.district_id,district_name,dta.collection_id,dta.collection_name,'0' as program_id,'all' as program_name,'all_collections' as type,'block' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'All' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg dta group by block_id,block_name,dta.district_id,dta.district_name,dta.collection_id,dta.collection_name UNION select block_id,block_name,dta.district_id,district_name,'0' as collection_id,'All' as collection_name,'0' as program_id,'All' as program_name,'all' as type,'block' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'All' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg dta group by block_id,block_name,dta.district_id,dta.district_name;"
    },
    {
        "diksha_tpd_r2_cluster_last_day": "select cluster_id,cluster_name,block_id,block_name,dta.district_id,district_name,dta.collection_id,dta.collection_name,program_id,program_name,'all_program_collections' as type,'cluster' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'Last_Day' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg dta join diksha_tpd_expected_enrollment dte on dta.collection_id=dte.collection_id  and dta.district_id=dte.district_id  where enrolled_date = (select ((now()::Date)-INTERVAL '1 DAY')::Date) and program_name is not NULL group by cluster_id,cluster_name,block_id,block_name,dta.district_id,dta.district_name,dta.collection_id,dta.collection_name,program_id,program_name UNION select cluster_id,cluster_name,block_id,block_name,dta.district_id,district_name,'0' as collection_id,'All' as collection_name,program_id,program_name,'all_programs' as type,'cluster' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'Last_Day' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg dta join diksha_tpd_expected_enrollment dte on dta.collection_id=dte.collection_id  and dta.district_id=dte.district_id  where enrolled_date = (select ((now()::Date)-INTERVAL '1 DAY')::Date) and program_name is not NULL group by cluster_id,cluster_name,block_id,block_name,dta.district_id,dta.district_name,program_id,program_name UNION select cluster_id,cluster_name,block_id,block_name,dta.district_id,district_name,dta.collection_id,dta.collection_name,'0' as program_id,'all' as program_name,'all_collections' as type,'cluster' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'Last_Day' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg dta where enrolled_date = (select ((now()::Date)-INTERVAL '1 DAY')::Date) group by cluster_id,cluster_name,block_id,block_name,dta.district_id,dta.district_name,dta.collection_id,dta.collection_name UNION select cluster_id,cluster_name,block_id,block_name,dta.district_id,district_name,'0' as collection_id,'All' as collection_name,'0' as program_id,'All' as program_name,'all' as type,'cluster' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'Last_Day' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg dta where enrolled_date = (select ((now()::Date)-INTERVAL '1 DAY')::Date) group by cluster_id,cluster_name,block_id,block_name,dta.district_id,dta.district_name;"
    },
    {
        "diksha_tpd_r2_cluster_last_7_days": "select cluster_id,cluster_name,block_id,block_name,dta.district_id,district_name,dta.collection_id,dta.collection_name,program_id,program_name,'all_program_collections' as type,'cluster' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'Last_7_Day' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg dta join diksha_tpd_expected_enrollment dte on dta.collection_id=dte.collection_id  and dta.district_id=dte.district_id  where enrolled_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE)  and program_name is not NULL group by cluster_id,cluster_name,block_id,block_name,dta.district_id,dta.district_name,dta.collection_id,dta.collection_name,program_id,program_name UNION select cluster_id,cluster_name,block_id,block_name,dta.district_id,district_name,'0' as collection_id,'All' as collection_name,program_id,program_name,'all_programs' as type,'cluster' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'Last_7_Day' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg dta join diksha_tpd_expected_enrollment dte on dta.collection_id=dte.collection_id  and dta.district_id=dte.district_id  where enrolled_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE)  and program_name is not NULL group by cluster_id,cluster_name,block_id,block_name,dta.district_id,dta.district_name,program_id,program_name UNION select cluster_id,cluster_name,block_id,block_name,dta.district_id,district_name,dta.collection_id,dta.collection_name,'0' as program_id,'all' as program_name,'all_collections' as type,'cluster' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'Last_7_Day' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg dta where enrolled_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE) group by cluster_id,cluster_name,block_id,block_name,dta.district_id,dta.district_name,dta.collection_id,dta.collection_name UNION select cluster_id,cluster_name,block_id,block_name,dta.district_id,district_name,'0' as collection_id,'All' as collection_name,'0' as program_id,'All' as program_name,'all' as type,'cluster' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'Last_7_Day' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg dta where enrolled_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE)  group by cluster_id,cluster_name,block_id,block_name,dta.district_id,dta.district_name;"
    },
    {
        "diksha_tpd_r2_cluster_last_30_days": "select cluster_id,cluster_name,block_id,block_name,dta.district_id,district_name,dta.collection_id,dta.collection_name,program_id,program_name,'all_program_collections' as type,'cluster' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'Last_30_Day' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg dta join diksha_tpd_expected_enrollment dte on dta.collection_id=dte.collection_id  and dta.district_id=dte.district_id  where enrolled_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE)  and program_name is not NULL group by cluster_id,cluster_name,block_id,block_name,dta.district_id,dta.district_name,dta.collection_id,dta.collection_name,program_id,program_name UNION select cluster_id,cluster_name,block_id,block_name,dta.district_id,district_name,'0' as collection_id,'All' as collection_name,program_id,program_name,'all_programs' as type,'cluster' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'Last_30_Day' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg dta join diksha_tpd_expected_enrollment dte on dta.collection_id=dte.collection_id  and dta.district_id=dte.district_id  where enrolled_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE)  and program_name is not NULL group by cluster_id,cluster_name,block_id,block_name,dta.district_id,dta.district_name,program_id,program_name UNION select cluster_id,cluster_name,block_id,block_name,dta.district_id,district_name,dta.collection_id,dta.collection_name,'0' as program_id,'all' as program_name,'all_collections' as type,'cluster' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'Last_30_Day' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg dta where enrolled_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE) group by cluster_id,cluster_name,block_id,block_name,dta.district_id,dta.district_name,dta.collection_id,dta.collection_name UNION select cluster_id,cluster_name,block_id,block_name,dta.district_id,district_name,'0' as collection_id,'All' as collection_name,'0' as program_id,'All' as program_name,'all' as type,'cluster' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'Last_30_Day' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg dta where enrolled_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE)  group by cluster_id,cluster_name,block_id,block_name,dta.district_id,dta.district_name;"
    },
    {
        "diksha_tpd_r2_cluster_last_90_days": "select cluster_id,cluster_name,block_id,block_name,dta.district_id,district_name,dta.collection_id,dta.collection_name,program_id,program_name,'all_program_collections' as type,'cluster' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'Last_90_Day' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg dta join diksha_tpd_expected_enrollment dte on dta.collection_id=dte.collection_id  and dta.district_id=dte.district_id  where enrolled_date between (select ((now()::Date)-INTERVAL '90 DAY')::Date) and (select now()::DATE)  and program_name is not NULL group by cluster_id,cluster_name,block_id,block_name,dta.district_id,dta.district_name,dta.collection_id,dta.collection_name,program_id,program_name UNION select cluster_id,cluster_name,block_id,block_name,dta.district_id,district_name,'0' as collection_id,'All' as collection_name,program_id,program_name,'all_programs' as type,'cluster' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'Last_90_Day' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg dta join diksha_tpd_expected_enrollment dte on dta.collection_id=dte.collection_id  and dta.district_id=dte.district_id  where enrolled_date between (select ((now()::Date)-INTERVAL '90 DAY')::Date) and (select now()::DATE)  and program_name is not NULL group by cluster_id,cluster_name,block_id,block_name,dta.district_id,dta.district_name,program_id,program_name UNION select cluster_id,cluster_name,block_id,block_name,dta.district_id,district_name,dta.collection_id,dta.collection_name,'0' as program_id,'all' as program_name,'all_collections' as type,'cluster' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'Last_90_Day' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg dta where enrolled_date between (select ((now()::Date)-INTERVAL '90 DAY')::Date) and (select now()::DATE) group by cluster_id,cluster_name,block_id,block_name,dta.district_id,dta.district_name,dta.collection_id,dta.collection_name UNION select cluster_id,cluster_name,block_id,block_name,dta.district_id,district_name,'0' as collection_id,'All' as collection_name,'0' as program_id,'All' as program_name,'all' as type,'cluster' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'Last_90_Day' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg dta where enrolled_date between (select ((now()::Date)-INTERVAL '90 DAY')::Date) and (select now()::DATE)  group by cluster_id,cluster_name,block_id,block_name,dta.district_id,dta.district_name;"
    },
    {
        "diksha_tpd_r2_cluster_overall": "select cluster_id,cluster_name,block_id,block_name,dta.district_id,district_name,dta.collection_id,dta.collection_name,program_id,program_name,'all_program_collections' as type,'cluster' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'All' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg dta join diksha_tpd_expected_enrollment dte on dta.collection_id=dte.collection_id  and dta.district_id=dte.district_id  where program_name is not NULL group by cluster_id,cluster_name,block_id,block_name,dta.district_id,dta.district_name,dta.collection_id,dta.collection_name,program_id,program_name UNION select cluster_id,cluster_name,block_id,block_name,dta.district_id,district_name,'0' as collection_id,'All' as collection_name,program_id,program_name,'all_programs' as type,'cluster' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'All' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg dta join diksha_tpd_expected_enrollment dte on dta.collection_id=dte.collection_id  and dta.district_id=dte.district_id  where program_name is not NULL group by cluster_id,cluster_name,block_id,block_name,dta.district_id,dta.district_name,program_id,program_name UNION select cluster_id,cluster_name,block_id,block_name,dta.district_id,district_name,dta.collection_id,dta.collection_name,'0' as program_id,'all' as program_name,'all_collections' as type,'cluster' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'All' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg dta group by cluster_id,cluster_name,block_id,block_name,dta.district_id,dta.district_name,dta.collection_id,dta.collection_name UNION select cluster_id,cluster_name,block_id,block_name,dta.district_id,district_name,'0' as collection_id,'All' as collection_name,'0' as program_id,'All' as program_name,'all' as type,'cluster' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'All' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg dta group by cluster_id,cluster_name,block_id,block_name,dta.district_id,dta.district_name;"
    },
    {
        "diksha_tpd_r2_school_last_day": "select school_id,school_name,cluster_id,cluster_name,block_id,block_name,dta.district_id,district_name,dta.collection_id,dta.collection_name,program_id,program_name,'all_program_collections' as type,'school' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'Last_Day' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg dta join diksha_tpd_expected_enrollment dte on dta.collection_id=dte.collection_id  and dta.district_id=dte.district_id  where enrolled_date = (select ((now()::Date)-INTERVAL '1 DAY')::Date) and program_name is not NULL group by school_id,school_name,cluster_id,cluster_name,block_id,block_name,dta.district_id,dta.district_name,dta.collection_id,dta.collection_name,program_id,program_name UNION select school_id,school_name,cluster_id,cluster_name,block_id,block_name,dta.district_id,district_name,'0' as collection_id,'All' as collection_name,program_id,program_name,'all_programs' as type,'school' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'Last_Day' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg dta join diksha_tpd_expected_enrollment dte on dta.collection_id=dte.collection_id  and dta.district_id=dte.district_id  where enrolled_date = (select ((now()::Date)-INTERVAL '1 DAY')::Date)  and program_name is not NULL group by school_id,school_name,cluster_id,cluster_name,block_id,block_name,dta.district_id,dta.district_name,program_id,program_name UNION select school_id,school_name,cluster_id,cluster_name,block_id,block_name,dta.district_id,district_name,dta.collection_id,dta.collection_name,'0' as program_id,'all' as program_name,'all_collections' as type,'school' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'Last_Day' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg dta where enrolled_date = (select ((now()::Date)-INTERVAL '1 DAY')::Date) group by school_id,school_name,cluster_id,cluster_name,block_id,block_name,dta.district_id,dta.district_name,dta.collection_id,dta.collection_name UNION select school_id,school_name,cluster_id,cluster_name,block_id,block_name,dta.district_id,district_name,'0' as collection_id,'All' as collection_name,'0' as program_id,'All' as program_name,'all' as type,'school' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'Last_Day' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg dta where enrolled_date = (select ((now()::Date)-INTERVAL '1 DAY')::Date) group by school_id,school_name,cluster_id,cluster_name,block_id,block_name,dta.district_id,dta.district_name;"
    },
    {
        "diksha_tpd_r2_school_last_7_days": "select school_id,school_name,cluster_id,cluster_name,block_id,block_name,dta.district_id,district_name,dta.collection_id,dta.collection_name,program_id,program_name,'all_program_collections' as type,'school' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'Last_7_Day' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg dta join diksha_tpd_expected_enrollment dte on dta.collection_id=dte.collection_id  and dta.district_id=dte.district_id  where enrolled_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE)  and program_name is not NULL group by school_id,school_name,cluster_id,cluster_name,block_id,block_name,dta.district_id,dta.district_name,dta.collection_id,dta.collection_name,program_id,program_name UNION select school_id,school_name,cluster_id,cluster_name,block_id,block_name,dta.district_id,district_name,'0' as collection_id,'All' as collection_name,program_id,program_name,'all_programs' as type,'school' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'Last_7_Day' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg dta join diksha_tpd_expected_enrollment dte on dta.collection_id=dte.collection_id  and dta.district_id=dte.district_id  where enrolled_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE)  and program_name is not NULL group by school_id,school_name,cluster_id,cluster_name,block_id,block_name,dta.district_id,dta.district_name,program_id,program_name UNION select school_id,school_name,cluster_id,cluster_name,block_id,block_name,dta.district_id,district_name,dta.collection_id,dta.collection_name,'0' as program_id,'all' as program_name,'all_collections' as type,'school' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'Last_7_Day' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg dta where enrolled_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE) group by school_id,school_name,cluster_id,cluster_name,block_id,block_name,dta.district_id,dta.district_name,dta.collection_id,dta.collection_name UNION select school_id,school_name,cluster_id,cluster_name,block_id,block_name,dta.district_id,district_name,'0' as collection_id,'All' as collection_name,'0' as program_id,'All' as program_name,'all' as type,'school' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'Last_7_Day' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg dta where enrolled_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE)  group by school_id,school_name,cluster_id,cluster_name,block_id,block_name,dta.district_id,dta.district_name;"
    },
    {
        "diksha_tpd_r2_school_last_30_days": "select school_id,school_name,cluster_id,cluster_name,block_id,block_name,dta.district_id,district_name,dta.collection_id,dta.collection_name,program_id,program_name,'all_program_collections' as type,'school' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'Last_30_Day' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg dta join diksha_tpd_expected_enrollment dte on dta.collection_id=dte.collection_id  and dta.district_id=dte.district_id  where enrolled_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE)  and program_name is not NULL group by school_id,school_name,cluster_id,cluster_name,block_id,block_name,dta.district_id,dta.district_name,dta.collection_id,dta.collection_name,program_id,program_name UNION select school_id,school_name,cluster_id,cluster_name,block_id,block_name,dta.district_id,district_name,'0' as collection_id,'All' as collection_name,program_id,program_name,'all_programs' as type,'school' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'Last_30_Day' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg dta join diksha_tpd_expected_enrollment dte on dta.collection_id=dte.collection_id  and dta.district_id=dte.district_id  where enrolled_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE)  and program_name is not NULL group by school_id,school_name,cluster_id,cluster_name,block_id,block_name,dta.district_id,dta.district_name,program_id,program_name UNION select school_id,school_name,cluster_id,cluster_name,block_id,block_name,dta.district_id,district_name,dta.collection_id,dta.collection_name,'0' as program_id,'all' as program_name,'all_collections' as type,'school' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'Last_30_Day' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg dta where enrolled_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE) group by school_id,school_name,cluster_id,cluster_name,block_id,block_name,dta.district_id,dta.district_name,dta.collection_id,dta.collection_name UNION select school_id,school_name,cluster_id,cluster_name,block_id,block_name,dta.district_id,district_name,'0' as collection_id,'All' as collection_name,'0' as program_id,'All' as program_name,'all' as type,'school' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'Last_30_Day' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg dta where enrolled_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE)  group by school_id,school_name,cluster_id,cluster_name,block_id,block_name,dta.district_id,dta.district_name;"
    },
    {
        "diksha_tpd_r2_school_last_90_days": "select school_id,school_name,cluster_id,cluster_name,block_id,block_name,dta.district_id,district_name,dta.collection_id,dta.collection_name,program_id,program_name,'all_program_collections' as type,'school' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'Last_90_Day' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg dta join diksha_tpd_expected_enrollment dte on dta.collection_id=dte.collection_id  and dta.district_id=dte.district_id  where enrolled_date between (select ((now()::Date)-INTERVAL '90 DAY')::Date) and (select now()::DATE)  and program_name is not NULL group by school_id,school_name,cluster_id,cluster_name,block_id,block_name,dta.district_id,dta.district_name,dta.collection_id,dta.collection_name,program_id,program_name UNION select school_id,school_name,cluster_id,cluster_name,block_id,block_name,dta.district_id,district_name,'0' as collection_id,'All' as collection_name,program_id,program_name,'all_programs' as type,'school' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'Last_90_Day' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg dta join diksha_tpd_expected_enrollment dte on dta.collection_id=dte.collection_id  and dta.district_id=dte.district_id  where enrolled_date between (select ((now()::Date)-INTERVAL '90 DAY')::Date) and (select now()::DATE) and program_name is not NULL group by school_id,school_name,cluster_id,cluster_name,block_id,block_name,dta.district_id,dta.district_name,program_id,program_name UNION select school_id,school_name,cluster_id,cluster_name,block_id,block_name,dta.district_id,district_name,dta.collection_id,dta.collection_name,'0' as program_id,'all' as program_name,'all_collections' as type,'school' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'Last_90_Day' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg dta where enrolled_date between (select ((now()::Date)-INTERVAL '90 DAY')::Date) and (select now()::DATE) group by school_id,school_name,cluster_id,cluster_name,block_id,block_name,dta.district_id,dta.district_name,dta.collection_id,dta.collection_name UNION select school_id,school_name,cluster_id,cluster_name,block_id,block_name,dta.district_id,district_name,'0' as collection_id,'All' as collection_name,'0' as program_id,'All' as program_name,'all' as type,'school' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'Last_90_Day' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg dta where enrolled_date between (select ((now()::Date)-INTERVAL '90 DAY')::Date) and (select now()::DATE)  group by school_id,school_name,cluster_id,cluster_name,block_id,block_name,dta.district_id,dta.district_name;"
    },
    {
        "diksha_tpd_r2_school_overall": "select school_id,school_name,cluster_id,cluster_name,block_id,block_name,dta.district_id,district_name,dta.collection_id,dta.collection_name,program_id,program_name,'all_program_collections' as type,'school' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'All' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg dta join diksha_tpd_expected_enrollment dte on dta.collection_id=dte.collection_id  and dta.district_id=dte.district_id  where program_name is not NULL group by school_id,school_name,cluster_id,cluster_name,block_id,block_name,dta.district_id,dta.district_name,dta.collection_id,dta.collection_name,program_id,program_name UNION select school_id,school_name,cluster_id,cluster_name,block_id,block_name,dta.district_id,district_name,'0' as collection_id,'All' as collection_name,program_id,program_name,'all_programs' as type,'school' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'All' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg dta join diksha_tpd_expected_enrollment dte on dta.collection_id=dte.collection_id  and dta.district_id=dte.district_id  where program_name is not NULL group by school_id,school_name,cluster_id,cluster_name,block_id,block_name,dta.district_id,dta.district_name,program_id,program_name UNION select school_id,school_name,cluster_id,cluster_name,block_id,block_name,dta.district_id,district_name,dta.collection_id,dta.collection_name,'0' as program_id,'all' as program_name,'all_collections' as type,'school' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'All' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg dta  group by school_id,school_name,cluster_id,cluster_name,block_id,block_name,dta.district_id,dta.district_name,dta.collection_id,dta.collection_name UNION select school_id,school_name,cluster_id,cluster_name,block_id,block_name,dta.district_id,district_name,'0' as collection_id,'All' as collection_name,'0' as program_id,'All' as program_name,'all' as type,'school' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,'All' as time_range,sum(certificate_count) as certificate_count from diksha_tpd_agg dta group by school_id,school_name,cluster_id,cluster_name,block_id,block_name,dta.district_id,dta.district_name;"
    },
    {
        "diksha_tpd_r2_raw_last_day": "select school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name,'collections' as type,'school 'as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,round(cast(sum(total_completed)as numeric)*100.0/cast(sum(total_enrolled)as numeric),1)as percentage_completion,'Last_Day' as time_range from diksha_tpd_agg where enrolled_date = (select now()::DATE) group by school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name"
    },
    {
        "diksha_tpd_r2_raw_last_7_days": "select school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name,'collections' as type,'school' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,round(cast(sum(total_completed)as numeric)*100.0/cast(sum(total_enrolled)as numeric),1)as percentage_completion,'Last_7_Day' as time_range from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '7 DAY')::Date) and (select now()::DATE) group by school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name"
    },
    {
        "diksha_tpd_r2_raw_last_30_days": "select school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name,'collections' as type,'school' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,round(cast(sum(total_completed)as numeric)*100.0/cast(sum(total_enrolled)as numeric),1)as percentage_completion,'Last_30_Day' as time_range from diksha_tpd_agg where enrolled_date between (select ((now()::Date)-INTERVAL '30 DAY')::Date) and (select now()::DATE) group by school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name"
    },
    {
        "diksha_tpd_r2_raw_overall": "select school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name,'collections' as type,'school' as level,sum(total_completed)as total_completed,sum(total_enrolled)as total_enrolled,round(cast(sum(total_completed)as numeric)*100.0/cast(sum(total_enrolled)as numeric),1)as percentage_completion,'All' as time_range from diksha_tpd_agg group by school_id,school_name,cluster_id,cluster_name,block_id,block_name,district_id,district_name,collection_id,collection_name"
    },
    {
        "diksha_tpd_enrolment_progress_all_program": "select res.program_id,res.program_name,res.dates as date,sum(res.day_wise) over (partition by res.program_id order by res.dates asc rows between unbounded preceding and current row) as expected_enrollment,sum(res.total_enrolled) over (partition by res.program_id order by res.dates asc rows unbounded preceding ) as net_enrollment from (select a.program_id,a.program_name,a.dates,sum(day_wise) as day_wise,case when sum(total_enrolled) is not null then sum(total_enrolled) else 0 end as total_enrolled from (select program_id,program_name,collection_id,district,collection_name,district_id,generate_series(course_start_date::date,course_end_date::date, '1 day'::interval)::date as dates from diksha_tpd_expected_enrollment  where course_end_date is not null ) as a join (select distinct collection_id,district_id,program_id,expected_enrollment,(course_end_date::date - course_start_date::date)+1 as duration,expected_enrollment/COALESCE((course_end_date::date - course_start_date::date)+1,1) as day_wise from diksha_tpd_expected_enrollment  where course_end_date is not null and expected_enrollment is not null  ) as b  on  a.collection_id=b.collection_id and a.district_id=b.district_id and a.program_id=b.program_id left join (select distinct collection_id,district_id,enrolled_date,sum(total_enrolled) as total_enrolled from diksha_tpd_agg group by collection_id,district_id,enrolled_date,collection_name) as tot_enrol on a.collection_id=tot_enrol.collection_id and a.district_id=tot_enrol.district_id and a.dates=tot_enrol.enrolled_date group by a.program_id,a.dates,a.program_name) as res group by res.program_id,res.dates,res.day_wise,total_enrolled,program_name;"
    },
    {
        "diksha_tpd_enrolment_progress_all_prog_coll": "select res.program_id,res.program_name,res.collection_id,collection_name,res.dates as date,sum(res.day_wise) over (partition by res.collection_id,res.program_id order by res.dates asc rows between unbounded preceding and current row) as expected_enrollment,sum(res.total_enrolled) over (partition by res.collection_id,res.program_id order by res.dates asc rows unbounded preceding ) as net_enrollment from (select a.program_id,a.program_name,a.collection_id,a.collection_name,a.dates,sum(day_wise) as day_wise,case when sum(total_enrolled) is not null then sum(total_enrolled) else 0 end as total_enrolled,enrolled_date from (select program_id,program_name,dte.collection_id,dta.collection_name,generate_series(course_start_date::date,course_end_date::date, '1 day'::interval)::date as dates from diksha_tpd_expected_enrollment dte  join (select distinct collection_id,collection_name from diksha_tpd_agg) dta on dte.collection_id=dta.collection_id where course_end_date is not null ) as a join (select distinct collection_id,expected_enrollment,(course_end_date::date - course_start_date::date)+1 as duration,expected_enrollment/COALESCE((course_end_date::date - course_start_date::date)+1,1) as day_wise from diksha_tpd_expected_enrollment where expected_enrollment is not null and  course_end_date is not null ) as b  on  a.collection_id=b.collection_id left join (select distinct collection_id,enrolled_date,sum(total_enrolled) as total_enrolled from diksha_tpd_agg group by collection_id,enrolled_date,collection_name) as tot_enrol on a.collection_id=tot_enrol.collection_id and a.dates=tot_enrol.enrolled_date group by a.collection_id,a.dates,enrolled_date,collection_name,a.program_id,a.program_name) as res where res.program_name is not NULL group by res.collection_id,res.dates,res.day_wise,total_enrolled,collection_name,program_id,program_name order by program_id,collection_id,date; "
    },
    {
        "diksha_tpd_enrolment_progress_all_coll_dist": "select res.program_id,res.program_name,res.collection_id,collection_name,res.district_id,shd.district_name,res.dates as date,sum(res.day_wise) over (partition by res.district_id,res.collection_id,res.program_id order by res.dates asc rows between unbounded preceding and current row) as expected_enrollment,sum(res.total_enrolled) over (partition by res.district_id,res.collection_id,res.program_id order by res.dates asc rows unbounded preceding ) as net_enrollment from (select a.program_id,a.program_name,a.collection_id,a.collection_name,a.district_id,a.district,a.dates,sum(day_wise) as day_wise,case when sum(total_enrolled) is not null then sum(total_enrolled) else 0 end as total_enrolled,enrolled_date from (select program_id,program_name,dte.collection_id,dta.collection_name,dte.district_id,district,generate_series(course_start_date::date,course_end_date::date, '1 day'::interval)::date as dates from diksha_tpd_expected_enrollment dte  join (select distinct collection_id,collection_name from diksha_tpd_agg) dta on dte.collection_id=dta.collection_id where course_end_date is not null ) as a join (select distinct collection_id,district_id,expected_enrollment,(course_end_date::date - course_start_date::date)+1 as duration,expected_enrollment/COALESCE((course_end_date::date - course_start_date::date)+1,1) as day_wise from diksha_tpd_expected_enrollment where expected_enrollment is not null and  course_end_date is not null ) as b  on a.collection_id=b.collection_id and a.district_id=b.district_id left join (select distinct collection_id,district_id,enrolled_date,sum(total_enrolled) as total_enrolled from diksha_tpd_agg group by collection_id,district_id,enrolled_date,collection_name) as tot_enrol on a.collection_id=tot_enrol.collection_id and a.district_id=tot_enrol.district_id and a.dates=tot_enrol.enrolled_date group by a.collection_id,a.district_id,a.dates,enrolled_date,collection_name,a.district,a.program_id,a.program_name) as res join school_hierarchy_details shd on res.district_id=shd.district_id where res.program_name is not NULL and res.district_id !=0 group by res.collection_id,res.district_id,res.dates,res.day_wise,total_enrolled,collection_name,district_name,program_id,program_name ; "
    },
    {
        "diksha_tpd_enrolment_progress_all_course": "select res.collection_id,res.collection_name,res.dates as date,sum(res.day_wise) over (partition by res.collection_id order by res.dates asc rows between unbounded preceding and current row) as expected_enrollment,sum(res.total_enrolled) over (partition by res.collection_id order by res.dates asc rows unbounded preceding ) as net_enrollment from (select a.collection_id,a.collection_name,a.dates,sum(day_wise) as day_wise,case when sum(total_enrolled) is not null then sum(total_enrolled) else 0 end as total_enrolled from (select dte.collection_id,district,dta.collection_name,dte.district_id,generate_series(course_start_date::date,course_end_date::date, '1 day'::interval)::date as dates from diksha_tpd_expected_enrollment dte  join (select distinct collection_id,collection_name from diksha_tpd_agg) dta on dte.collection_id=dta.collection_id where course_end_date is not null ) as a join (select distinct collection_id,district_id,expected_enrollment,(course_end_date::date - course_start_date::date)+1 as duration,expected_enrollment/COALESCE((course_end_date::date - course_start_date::date)+1,1) as day_wise from diksha_tpd_expected_enrollment  where expected_enrollment is not null and  course_end_date is not null ) as b  on  a.collection_id=b.collection_id and a.district_id=b.district_id left join (select distinct collection_id,district_id,enrolled_date,sum(total_enrolled) as total_enrolled from diksha_tpd_agg group by collection_id,district_id,enrolled_date,collection_name) as tot_enrol on a.collection_id=tot_enrol.collection_id and a.district_id=tot_enrol.district_id and a.dates=tot_enrol.enrolled_date group by a.collection_id,a.dates,a.collection_name) as res group by collection_id,res.dates,res.day_wise,total_enrolled,collection_name; "
    },
    {
        "diksha_tpd_enrolment_progress_state": "select res.dates as date,sum(res.day_wise) over (order by res.dates asc rows between unbounded preceding and current row) as expected_enrollment,sum(res.total_enrolled) over (order by res.dates asc rows unbounded preceding ) as net_enrollment from (select a.dates,sum(day_wise) as day_wise,case when sum(total_enrolled) is not null then sum(total_enrolled) else 0 end as total_enrolled from (select collection_id,district,collection_name,district_id,generate_series(course_start_date::date,course_end_date::date, '1 day'::interval)::date as dates from diksha_tpd_expected_enrollment  where course_end_date is not null ) as a join (select distinct collection_id,district_id,expected_enrollment,(course_end_date::date - course_start_date::date)+1 as duration,expected_enrollment/COALESCE((course_end_date::date - course_start_date::date)+1,1) as day_wise from diksha_tpd_expected_enrollment  where expected_enrollment is not null and  course_end_date is not null ) as b  on  a.collection_id=b.collection_id and a.district_id=b.district_id left join (select distinct collection_id,district_id,enrolled_date,sum(total_enrolled) as total_enrolled from diksha_tpd_agg group by collection_id,district_id,enrolled_date,collection_name) as tot_enrol on a.collection_id=tot_enrol.collection_id and a.district_id=tot_enrol.district_id and a.dates=tot_enrol.enrolled_date group by a.dates) as res group by res.dates,res.day_wise,total_enrolled;"
    },
    {
        "diksha_tpd_enrolment_progress_all_coll_state": "select res.collection_id,collection_name,res.district_id,shd.district_name,res.dates as date,sum(res.day_wise) over (partition by res.district_id,res.collection_id order by res.dates asc rows between unbounded preceding and current row) as expected_enrollment,sum(res.total_enrolled) over (partition by res.district_id,res.collection_id order by res.dates asc rows unbounded preceding ) as net_enrollment from (select a.collection_id,a.collection_name,a.district_id,a.district,a.dates,sum(day_wise) as day_wise,case when sum(total_enrolled) is not null then sum(total_enrolled) else 0 end as total_enrolled,enrolled_date from (select dte.collection_id,dta.collection_name,dte.district_id,district,generate_series(course_start_date::date,course_end_date::date, '1 day'::interval)::date as dates from diksha_tpd_expected_enrollment dte  join (select distinct collection_id,collection_name from diksha_tpd_agg) dta on dte.collection_id=dta.collection_id  where course_end_date is not null ) as a join (select distinct collection_id,district_id,expected_enrollment,(course_end_date::date - course_start_date::date)+1 as duration,expected_enrollment/COALESCE((course_end_date::date - course_start_date::date)+1,1) as day_wise from diksha_tpd_expected_enrollment where expected_enrollment is not null and  course_end_date is not null ) as b  on a.collection_id=b.collection_id and a.district_id=b.district_id left join (select distinct collection_id,district_id,enrolled_date,sum(total_enrolled) as total_enrolled from diksha_tpd_agg group by collection_id,district_id,enrolled_date,collection_name) as tot_enrol on a.collection_id=tot_enrol.collection_id and a.district_id=tot_enrol.district_id and a.dates=tot_enrol.enrolled_date group by a.collection_id,a.district_id,a.dates,enrolled_date,collection_name,a.district) as res join school_hierarchy_details shd on res.district_id=shd.district_id where res.district_id !=0 group by res.collection_id,res.district_id,res.dates,res.day_wise,total_enrolled,collection_name,district_name;"
    }
]